See cka-notes.ipynb for the full notes.